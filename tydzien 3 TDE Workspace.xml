<export><workspace name="tydzien 3 TDE"><query name="test template" focus="false" listorder="1" taborder="1" active="true" database="4764615340605620970" server="11761150019421516864" database-name="petstore-content" server-name="petstore" mode="xquery">xquery version "1.0-ml";

let $pets-template :=
&lt;template xmlns="http://marklogic.com/xdmp/tde"&gt;   
  &lt;context&gt;pet&lt;/context&gt;
  &lt;vars&gt;
    &lt;var&gt;
      &lt;name&gt;date&lt;/name&gt;
      &lt;val&gt;xdmp:parse-dateTime("[D01]-[M01]-[Y0001]",birth)&lt;/val&gt;
    &lt;/var&gt;
  &lt;/vars&gt; 
  &lt;rows&gt; 
    &lt;row&gt; 
      &lt;schema-name&gt;pets&lt;/schema-name&gt; 
      &lt;view-name&gt;pets&lt;/view-name&gt; 
      &lt;columns&gt; 
        &lt;column&gt;
          &lt;name&gt;name&lt;/name&gt; 
          &lt;scalar-type&gt;string&lt;/scalar-type&gt; 
          &lt;val&gt;name&lt;/val&gt; 
          &lt;nullable&gt;true&lt;/nullable&gt;
          &lt;invalid-values&gt;ignore&lt;/invalid-values&gt;          
        &lt;/column&gt; 
        &lt;column&gt;
          &lt;name&gt;species&lt;/name&gt; 
          &lt;scalar-type&gt;string&lt;/scalar-type&gt; 
          &lt;val&gt;species&lt;/val&gt;
          &lt;nullable&gt;true&lt;/nullable&gt;
          &lt;invalid-values&gt;ignore&lt;/invalid-values&gt; 
        &lt;/column&gt;
        &lt;column&gt;
          &lt;name&gt;birth&lt;/name&gt; 
          &lt;scalar-type&gt;dateTime&lt;/scalar-type&gt; 
          &lt;val&gt;$date&lt;/val&gt;
          &lt;nullable&gt;true&lt;/nullable&gt;
          &lt;invalid-values&gt;ignore&lt;/invalid-values&gt; 
        &lt;/column&gt;
      &lt;/columns&gt;
    &lt;/row&gt;
  &lt;/rows&gt;
&lt;/template&gt;

return 
(:tde:validate($pets-template):)
tde:node-data-extract(fn:doc("Meowsalot.xml"), $pets-template)
</query><query name="date parse" focus="false" listorder="2" taborder="2" active="true" database="4764615340605620970" server="11761150019421516864" database-name="petstore-content" server-name="petstore" mode="xquery">xquery version "1.0-ml";
 xdmp:parse-dateTime("[D01]-[M01]-[Y0001]",
		   fn:doc("Meowsalot.xml")/pet/birth)</query><query name="Query 3" focus="false" listorder="3" taborder="" active="false" database="4764615340605620970" server="11761150019421516864" database-name="petstore-content" server-name="petstore" mode="xquery">xquery version "1.0-ml";
fn:doc("Meowsalot.xml")/pet/birth/string()</query><query name="create a view" focus="false" listorder="4" taborder="3" active="true" database="4764615340605620970" server="11761150019421516864" database-name="petstore-content" server-name="petstore" mode="xquery">import module "http://marklogic.com/xdmp/tde" at "/MarkLogic/tde.xqy";

let $pets-template :=
&lt;template xmlns="http://marklogic.com/xdmp/tde"&gt;   
  &lt;context&gt;pet&lt;/context&gt;
  &lt;vars&gt;
    &lt;var&gt;
      &lt;name&gt;date&lt;/name&gt;
      &lt;val&gt;xdmp:parse-dateTime("[D01]-[M01]-[Y0001]",birth)&lt;/val&gt;
    &lt;/var&gt;
  &lt;/vars&gt; 
  &lt;rows&gt; 
    &lt;row&gt; 
      &lt;schema-name&gt;pets&lt;/schema-name&gt; 
      &lt;view-name&gt;pets&lt;/view-name&gt; 
      &lt;columns&gt; 
        &lt;column&gt;
          &lt;name&gt;name&lt;/name&gt; 
          &lt;scalar-type&gt;string&lt;/scalar-type&gt; 
          &lt;val&gt;name&lt;/val&gt; 
          &lt;nullable&gt;true&lt;/nullable&gt;
          &lt;invalid-values&gt;ignore&lt;/invalid-values&gt;          
        &lt;/column&gt; 
        &lt;column&gt;
          &lt;name&gt;species&lt;/name&gt; 
          &lt;scalar-type&gt;string&lt;/scalar-type&gt; 
          &lt;val&gt;species&lt;/val&gt;
          &lt;nullable&gt;true&lt;/nullable&gt;
          &lt;invalid-values&gt;ignore&lt;/invalid-values&gt; 
        &lt;/column&gt;
        &lt;column&gt;
          &lt;name&gt;birth&lt;/name&gt; 
          &lt;scalar-type&gt;dateTime&lt;/scalar-type&gt; 
          &lt;val&gt;$date&lt;/val&gt;
          &lt;nullable&gt;true&lt;/nullable&gt;
          &lt;invalid-values&gt;ignore&lt;/invalid-values&gt; 
        &lt;/column&gt;
      &lt;/columns&gt;
    &lt;/row&gt;
  &lt;/rows&gt;
&lt;/template&gt;

return tde:template-insert("petstore.xml", $pets-template)
</query><query name="query view" focus="true" listorder="5" taborder="4" active="true" database="4764615340605620970" server="11761150019421516864" database-name="petstore-content" server-name="petstore" mode="sql">-- query
select * from pets</query></workspace></export>
